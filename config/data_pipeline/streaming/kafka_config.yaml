# PBF-LB/M Data Pipeline - Kafka Configuration
# This file contains Kafka-specific configuration settings

kafka:
  # Kafka cluster configuration
  cluster:
    bootstrap_servers: "${KAFKA_BOOTSTRAP_SERVERS}"
    security_protocol: "PLAINTEXT"
    sasl_mechanism: null
    sasl_username: null
    sasl_password: null
    ssl_enabled: false
    
  # Producer configuration
  producer:
    acks: "all"
    retries: 3
    batch_size: 16384
    linger_ms: 5
    buffer_memory: 33554432
    compression_type: "snappy"
    max_request_size: 1048576
    request_timeout_ms: 30000
    delivery_timeout_ms: 120000
    
  # Consumer configuration
  consumer:
    group_id: "pbf_lbm_consumer_group"
    auto_offset_reset: "earliest"
    enable_auto_commit: true
    auto_commit_interval_ms: 1000
    session_timeout_ms: 30000
    heartbeat_interval_ms: 3000
    max_poll_records: 500
    fetch_min_bytes: 1
    fetch_max_wait_ms: 500
    max_partition_fetch_bytes: 1048576
    
  # Topics configuration
  topics:
    # ISPM Monitoring Events
    ispm_monitoring_events:
      name: "ispm_monitoring_events"
      partitions: 12
      replication_factor: 3
      retention_ms: 604800000  # 7 days
      segment_ms: 86400000  # 1 day
      compression_type: "snappy"
      cleanup_policy: "delete"
      
    # Powder Bed Monitoring Events
    powder_bed_monitoring_events:
      name: "powder_bed_monitoring_events"
      partitions: 8
      replication_factor: 3
      retention_ms: 604800000  # 7 days
      segment_ms: 86400000  # 1 day
      compression_type: "snappy"
      cleanup_policy: "delete"
      
    # CT Scan Events
    ct_scan_events:
      name: "ct_scan_events"
      partitions: 4
      replication_factor: 3
      retention_ms: 2592000000  # 30 days
      segment_ms: 86400000  # 1 day
      compression_type: "snappy"
      cleanup_policy: "delete"
      
    # PBF Process Events
    pbf_process_events:
      name: "pbf_process_events"
      partitions: 6
      replication_factor: 3
      retention_ms: 2592000000  # 30 days
      segment_ms: 86400000  # 1 day
      compression_type: "snappy"
      cleanup_policy: "delete"
      
    # Data Quality Events
    data_quality_events:
      name: "data_quality_events"
      partitions: 4
      replication_factor: 3
      retention_ms: 2592000000  # 30 days
      segment_ms: 86400000  # 1 day
      compression_type: "snappy"
      cleanup_policy: "delete"
      
    # Alert Events
    alert_events:
      name: "alert_events"
      partitions: 2
      replication_factor: 3
      retention_ms: 2592000000  # 30 days
      segment_ms: 86400000  # 1 day
      compression_type: "snappy"
      cleanup_policy: "delete"
      
  # Consumer groups configuration
  consumer_groups:
    ispm_monitoring_etl_consumer:
      group_id: "ispm_monitoring_etl_consumer"
      topics: ["ispm_monitoring_events"]
      auto_offset_reset: "latest"
      enable_auto_commit: true
      
    powder_bed_etl_consumer:
      group_id: "powder_bed_etl_consumer"
      topics: ["powder_bed_monitoring_events"]
      auto_offset_reset: "latest"
      enable_auto_commit: true
      
    ct_scan_etl_consumer:
      group_id: "ct_scan_etl_consumer"
      topics: ["ct_scan_events"]
      auto_offset_reset: "latest"
      enable_auto_commit: true
      
    pbf_process_etl_consumer:
      group_id: "pbf_process_etl_consumer"
      topics: ["pbf_process_events"]
      auto_offset_reset: "latest"
      enable_auto_commit: true
      
    data_quality_consumer:
      group_id: "data_quality_consumer"
      topics: ["data_quality_events"]
      auto_offset_reset: "latest"
      enable_auto_commit: true
      
    alert_consumer:
      group_id: "alert_consumer"
      topics: ["alert_events"]
      auto_offset_reset: "latest"
      enable_auto_commit: true
      
  # Schema registry configuration
  schema_registry:
    enabled: true
    url: "${SCHEMA_REGistry_URL}"
    auto_register_schemas: true
    schema_evolution: "BACKWARD"
    
  # Monitoring configuration
  monitoring:
    enabled: true
    metrics_enabled: true
    jmx_enabled: true
    health_check_interval: 60
    
  # Security configuration
  security:
    encryption_enabled: true
    authentication_required: true
    ssl_enabled: false  # Will be enabled in production
    audit_logging: true
    
  # Performance tuning
  performance:
    num_network_threads: 3
    num_io_threads: 8
    socket_send_buffer_bytes: 102400
    socket_receive_buffer_bytes: 102400
    socket_request_max_bytes: 104857600
    num_replica_fetchers: 1
    replica_fetch_max_bytes: 1048576
    replica_socket_timeout_ms: 30000
    replica_fetch_wait_max_ms: 500
    replica_high_watermark_checkpoint_interval_ms: 5000
    replica_lag_time_max_ms: 10000
    replica_socket_receive_buffer_bytes: 65536
    replica_fetch_min_bytes: 1
    num_recovery_threads_per_data_dir: 1
    auto_create_topics_enable: true
    min_insync_replicas: 2
    default_replication_factor: 3
    
  # Environment-specific overrides
  environments:
    development:
      bootstrap_servers: "localhost:9092"
      security_protocol: "PLAINTEXT"
      ssl_enabled: false
      replication_factor: 1
      
    staging:
      bootstrap_servers: "staging-kafka.example.com:9092"
      security_protocol: "PLAINTEXT"
      ssl_enabled: false
      replication_factor: 2
      
    production:
      bootstrap_servers: "prod-kafka-cluster.example.com:9092"
      security_protocol: "SASL_SSL"
      ssl_enabled: true
      replication_factor: 3
